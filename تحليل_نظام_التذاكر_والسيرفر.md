# ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ°Ø§ÙƒØ± ÙˆØ®Ø§Ø¯Ù… Socket

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØªÙƒÙˆÙ† Ù…Ù† Ø¬Ø²Ø¦ÙŠÙ† Ø±Ø¦ÙŠØ³ÙŠÙŠÙ†:
1. **Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ°Ø§ÙƒØ± (Ticket System)** - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ØªØ°Ø§ÙƒØ± Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ
2. **Ø®Ø§Ø¯Ù… Socket.IO** - Ø®Ø§Ø¯Ù… WebSocket Ù„Ù„ØªÙˆØ§ØµÙ„ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ

---

## ğŸ¨ Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (Next.js)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Admin Panel     â”‚         â”‚  User Interface  â”‚         â”‚
â”‚  â”‚  /admin/tickets  â”‚         â”‚  /user/support   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                            â”‚                    â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                        â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚     React Components (UI Layer)               â”‚          â”‚
â”‚  â”‚  â€¢ TicketList, TicketChat, TicketDetails     â”‚          â”‚
â”‚  â”‚  â€¢ CreateTicketModal, TicketSidebar          â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚           â”‚                            â”‚                    â”‚
â”‚           â”‚                            â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  useTicketSocket â”‚         â”‚  REST API Calls â”‚          â”‚
â”‚  â”‚  (Socket Hook)   â”‚         â”‚  (HTTP Requests)â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                            â”‚
             â”‚ WebSocket                  â”‚ HTTP
             â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Socket Server (Port 5000)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚         Socket.IO Event Handlers             â”‚         â”‚
â”‚  â”‚  â€¢ join_ticket, leave_ticket                 â”‚         â”‚
â”‚  â”‚  â€¢ send_message, typing                      â”‚         â”‚
â”‚  â”‚  â€¢ ticket_status_change, assign_agent       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                            â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  In-Memory Store â”‚         â”‚  REST Endpoints â”‚          â”‚
â”‚  â”‚  â€¢ ticketRooms  â”‚         â”‚  â€¢ /tickets     â”‚          â”‚
â”‚  â”‚  â€¢ socketTicketsâ”‚         â”‚  â€¢ /health      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Next.js API Routes (Port 3000)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚         API Endpoints                         â”‚         â”‚
â”‚  â”‚  â€¢ GET/POST  /api/tickets                    â”‚         â”‚
â”‚  â”‚  â€¢ GET/PATCH /api/tickets/[id]               â”‚         â”‚
â”‚  â”‚  â€¢ GET/POST  /api/user/tickets               â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MongoDB Database                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Tickets        â”‚         â”‚   Messages       â”‚         â”‚
â”‚  â”‚   Collection     â”‚         â”‚   Collection     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  â€¢ ticketNumber (indexed)                                  â”‚
â”‚  â€¢ userId, assigneeId (indexed)                            â”‚
â”‚  â€¢ status, priority (indexed)                             â”‚
â”‚  â€¢ messages[] (embedded)                                  â”‚
â”‚  â€¢ activityLogs[] (embedded)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:

1. **Ø¥Ù†Ø´Ø§Ø¡ ØªØ°ÙƒØ±Ø©**: Frontend â†’ REST API â†’ MongoDB
2. **Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©**: Frontend â†’ Socket.IO â†’ MongoDB â†’ Broadcast
3. **ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø©**: Frontend â†’ Socket.IO â†’ MongoDB â†’ Broadcast
4. **Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„**: Frontend â†’ REST API â†’ MongoDB

---

---

## ğŸ—ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

### 1. Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ°Ø§ÙƒØ± (Backend - Next.js API Routes)

#### Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
- `models/Ticket.ts` - Ù†Ù…ÙˆØ°Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ°ÙƒØ±Ø© ÙÙŠ MongoDB
- `app/api/tickets/route.ts` - API endpoints Ù„Ù„ØªØ°Ø§ÙƒØ±
- `app/api/user/tickets/route.ts` - API endpoints Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- `types/ticket.ts` - ØªØ¹Ø±ÙŠÙØ§Øª TypeScript

#### Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:
- âœ… Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ°Ø§ÙƒØ±
- âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª (low, medium, high, urgent)
- âœ… Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ°Ø§ÙƒØ± (open, pending, resolved, closed)
- âœ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ (Agents)
- âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¯Ù…Ø¬
- âœ… Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø© (Activity Logs)
- âœ… Ù†Ø¸Ø§Ù… SLA (Service Level Agreement)
- âœ… ØªØªØ¨Ø¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©

---

### 2. Ø®Ø§Ø¯Ù… Socket.IO (Socket Server)

#### Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
- `socket-server/src/app.ts` - Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
- `socket-server/src/socket/index.ts` - Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Socket.IO
- `socket-server/src/models/Ticket.ts` - Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ°ÙƒØ±Ø©
- `socket-server/src/models/Message.ts` - Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
- `socket-server/src/types.ts` - ØªØ¹Ø±ÙŠÙØ§Øª TypeScript

#### Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:
- âœ… Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
- âœ… Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø© (Typing Indicators)
- âœ… ØªØªØ¨Ø¹ Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- âœ… ØªØ­Ø¯ÙŠØ«Ø§Øª Ø­Ø§Ù„Ø© Ø§Ù„ØªØ°ÙƒØ±Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©
- âœ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
- âœ… Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© (Read Receipts)

---

## ğŸ¨ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (UI Components)

### Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:

#### 1. **TicketList** (`components/tickets/ticket-list.tsx`)
- Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ°Ø§ÙƒØ±
- ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
- Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©
- Ø¯Ø¹Ù… Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„

#### 2. **TicketChat** (`components/tickets/ticket-chat.tsx`)
- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
- Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
- Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©
- Ø¯Ø¹Ù… Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª
- Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø±ÙŠØ¹Ø©

#### 3. **TicketDetails** (`components/tickets/ticket-details.tsx`)
- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ°ÙƒØ±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
- ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
- ØªØ¹ÙŠÙŠÙ† ÙˆÙƒÙŠÙ„
- Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©
- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª SLA

#### 4. **TicketSidebar** (`components/tickets/ticket-sidebar.tsx`)
- Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ Ù„Ù„ÙÙ„ØªØ±Ø©
- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ°Ø§ÙƒØ±
- Ø£Ø²Ø±Ø§Ø± Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ø¥Ù†Ø´Ø§Ø¡

#### 5. **CreateTicketModal** (`components/tickets/create-ticket-modal.tsx`)
- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ù†Ø´Ø§Ø¡ ØªØ°ÙƒØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¦Ø© ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
- Ø¥Ø¶Ø§ÙØ© ÙˆØµÙ Ø£ÙˆÙ„ÙŠ

### Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:

- **`app/admin/tickets/page.tsx`** - Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
- **`app/user/support/page.tsx`** - ØµÙØ­Ø© Ø¯Ø¹Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

---

## ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ°ÙƒØ±Ø© (Ticket Model)

```typescript
interface ITicket {
  _id: ObjectId
  ticketNumber: string        // Ø±Ù‚Ù… ÙØ±ÙŠØ¯: TKT24011234
  title: string              // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ°ÙƒØ±Ø©
  category: string           // ÙØ¦Ø©: general, technical, billing, etc.
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
  userId: ObjectId
  customerName: string
  customerEmail: string
  customerAvatar?: string
  
  // Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
  status: "open" | "pending" | "resolved" | "closed"
  priority: "low" | "medium" | "high" | "urgent"
  
  // Ø§Ù„ØªØ¹ÙŠÙŠÙ†
  assigneeId?: ObjectId
  assigneeName?: string
  assigneeAvatar?: string
  
  // Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
  messages: ITicketMessage[]
  lastMessage: string
  unreadCount: number          // ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡
  unreadByCustomer: number     // ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„
  
  // Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©
  activityLogs: ITicketActivity[]
  
  // SLA
  slaDeadline?: Date           // Ù…ÙˆØ¹Ø¯ Ù†Ù‡Ø§Ø¦ÙŠ 24 Ø³Ø§Ø¹Ø©
  
  // Ø§Ù„Ø·ÙˆØ§Ø¨Ø¹ Ø§Ù„Ø²Ù…Ù†ÙŠØ©
  createdAt: Date
  updatedAt: Date
}
```

### Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø³Ø§Ù„Ø© (Message Model)

```typescript
interface ITicketMessage {
  _id: ObjectId
  content: string
  sender: "customer" | "agent" | "system"
  senderId?: ObjectId
  senderName: string
  type: "text" | "system" | "attachment"
  attachments?: Attachment[]
  createdAt: Date
}
```

---

## ğŸ”Œ Socket.IO Events

### Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… (Client â†’ Server)

| Event | Ø§Ù„ÙˆØµÙ | Payload |
|-------|-------|---------|
| `join_ticket` | Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØºØ±ÙØ© ØªØ°ÙƒØ±Ø© | `{ ticketId, userId, userType, userName }` |
| `leave_ticket` | Ù…ØºØ§Ø¯Ø±Ø© ØºØ±ÙØ© ØªØ°ÙƒØ±Ø© | `{ ticketId, userId }` |
| `send_message` | Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© | `{ ticketId, senderId, senderType, senderName, content, attachments? }` |
| `typing` | Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© | `{ ticketId, senderId, senderName, isTyping }` |
| `ticket_status_change` | ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ°ÙƒØ±Ø© | `{ ticketId, status, changedBy, changedByName }` |
| `assign_agent` | ØªØ¹ÙŠÙŠÙ† ÙˆÙƒÙŠÙ„ | `{ ticketId, agentId, agentName, assignedBy }` |
| `mark_as_read` | ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø© | `{ ticketId, userId }` |

### Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„ (Server â†’ Client)

| Event | Ø§Ù„ÙˆØµÙ | Payload |
|-------|-------|---------|
| `message_received` | Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© | `{ message, ticketId }` |
| `typing_indicator` | Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© | `{ ticketId, senderId, senderName, isTyping }` |
| `ticket_updated` | ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ°ÙƒØ±Ø© | `{ ticketId, status, changedBy, changedByName, timestamp }` |
| `user_joined` | Ø§Ù†Ø¶Ù…Ø§Ù… Ù…Ø³ØªØ®Ø¯Ù… | `{ ticketId, userId, userName, userType, timestamp }` |
| `user_left` | Ù…ØºØ§Ø¯Ø±Ø© Ù…Ø³ØªØ®Ø¯Ù… | `{ ticketId, userId, userName, timestamp }` |
| `agent_assigned` | ØªØ¹ÙŠÙŠÙ† ÙˆÙƒÙŠÙ„ | `{ ticketId, agentId, agentName, timestamp }` |
| `messages_read` | ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø© | `{ ticketId, userId }` |
| `error` | Ø®Ø·Ø£ | `{ message, code }` |

---

## ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø¹Ù…Ù„ (Workflow)

### 1. Ø¥Ù†Ø´Ø§Ø¡ ØªØ°ÙƒØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©

```
Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… â†’ POST /api/tickets
         â†“
    Ø¥Ù†Ø´Ø§Ø¡ Ticket ÙÙŠ MongoDB
         â†“
    Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„ÙŠØ©
         â†“
    Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¬Ù„ Ù†Ø´Ø§Ø·
         â†“
    Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„ØªØ°ÙƒØ±Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
```

### 2. Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ

```
Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… â†’ socket.emit("send_message")
         â†“
    Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªØ°ÙƒØ±Ø©
         â†“
    Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙŠ MongoDB
         â†“
    ØªØ­Ø¯ÙŠØ« lastMessage Ùˆ unreadCount
         â†“
    Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¬Ù…ÙŠØ¹ ÙÙŠ Ø§Ù„ØºØ±ÙØ©: socket.to(room).emit("message_received")
```

### 3. ØªØ¹ÙŠÙŠÙ† ÙˆÙƒÙŠÙ„

```
Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ â†’ socket.emit("assign_agent")
         â†“
    ØªØ­Ø¯ÙŠØ« Ticket.agentId
         â†“
    ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ "pending"
         â†“
    Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ù†Ø¸Ø§Ù…
         â†“
    Ø¥Ø±Ø³Ø§Ù„ event Ù„Ù„Ø¬Ù…ÙŠØ¹: "agent_assigned"
```

---

## ğŸ¯ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©

### âœ… Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©:

1. **Ø¨Ù†ÙŠØ© Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø¬ÙŠØ¯Ø©**
   - ÙØµÙ„ ÙˆØ§Ø¶Ø­ Ø¨ÙŠÙ† Backend Ùˆ Socket Server
   - Ø§Ø³ØªØ®Ø¯Ø§Ù… TypeScript Ù„Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©
   - Ù†Ù…Ø§Ø°Ø¬ MongoDB Ù…Ù†Ø¸Ù…Ø©

2. **Ù…ÙŠØ²Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©**
   - Ù†Ø¸Ø§Ù… SLA ØªÙ„Ù‚Ø§Ø¦ÙŠ (24 Ø³Ø§Ø¹Ø©)
   - ØªØªØ¨Ø¹ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ÙƒØ§Ù…Ù„
   - Ù†Ø¸Ø§Ù… Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ù…Ø±Ù†
   - Ø¯Ø¹Ù… Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª

3. **Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯**
   - ÙÙ‡Ø±Ø³Ø© MongoDB Ù…Ø­Ø³Ù‘Ù†Ø©
   - Ø§Ø³ØªØ®Ø¯Ø§Ù… Rooms ÙÙŠ Socket.IO
   - ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©

4. **ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù…ØªØ§Ø²Ø©**
   - Ø±Ø³Ø§Ø¦Ù„ ÙÙˆØ±ÙŠØ©
   - Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©
   - ØªØªØ¨Ø¹ Ø§Ù„Ø­Ø¶ÙˆØ±
   - ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø©

---

## âš ï¸ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©

### ğŸ”§ ØªØ­Ø³ÙŠÙ†Ø§Øª Ù…Ù‚ØªØ±Ø­Ø©:

1. **Ø§Ù„Ø£Ù…Ø§Ù†**
   - âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ Socket events
   - âœ… **Ù…Ù‚ØªØ±Ø­**: Ø¥Ø¶Ø§ÙØ© Authentication middleware
   - âœ… **Ù…Ù‚ØªØ±Ø­**: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙƒÙŠØ© Ø§Ù„ØªØ°ÙƒØ±Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…

2. **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡**
   - âš ï¸ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·
   - âœ… **Ù…Ù‚ØªØ±Ø­**: Ø¥Ø¶Ø§ÙØ© Retry logic
   - âœ… **Ù…Ù‚ØªØ±Ø­**: Logging Ù…Ø­Ø³Ù‘Ù†

3. **Ø§Ù„Ø£Ø¯Ø§Ø¡**
   - âš ï¸ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© ÙÙ‚Ø·
   - âœ… **Ù…Ù‚ØªØ±Ø­**: Ø§Ø³ØªØ®Ø¯Ø§Ù… Redis Ù„Ù„Ù€ Scaling
   - âœ… **Ù…Ù‚ØªØ±Ø­**: Rate limiting Ù„Ù„Ù€ Socket events

4. **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**
   - âš ï¸ Ù†Ù…ÙˆØ°Ø¬Ø§Ù† Ù…Ø®ØªÙ„ÙØ§Ù† Ù„Ù„ØªØ°ÙƒØ±Ø© (ÙÙŠ Backend Ùˆ Socket Server)
   - âœ… **Ù…Ù‚ØªØ±Ø­**: ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Shared package

5. **Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©**
   - âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø¸Ø§Ù… Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Notifications)
   - âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
   - âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ°Ø§ÙƒØ±
   - âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… (Rating)

---

## ğŸ“ˆ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙØªØ­ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù…
```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ…Ù„Ø£ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
2. POST /api/tickets â†’ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ°ÙƒØ±Ø©
3. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ†Ø¶Ù… Ù„Ù„ØºØ±ÙØ©: join_ticket
4. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ±Ø³Ù„ Ø±Ø³Ø§Ù„Ø©: send_message
5. Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠØ³ØªÙ‚Ø¨Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙÙˆØ±ÙŠ
```

### 2. ÙˆÙƒÙŠÙ„ ÙŠØ±Ø¯ Ø¹Ù„Ù‰ ØªØ°ÙƒØ±Ø©
```
1. Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠÙ†Ø¶Ù… Ù„Ù„ØºØ±ÙØ©: join_ticket
2. Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠØ±Ù‰ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
3. Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠÙƒØªØ¨ â†’ typing indicator
4. Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠØ±Ø³Ù„ Ø§Ù„Ø±Ø¯: send_message
5. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø±Ø¯ ÙÙˆØ±Ø§Ù‹
```

### 3. ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ°ÙƒØ±Ø©
```
1. Ø§Ù„ÙˆÙƒÙŠÙ„ ÙŠØºÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©: ticket_status_change
2. ØªØ­Ø¯ÙŠØ« ÙÙŠ MongoDB
3. Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ù†Ø¸Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
4. Ø¥Ø±Ø³Ø§Ù„ ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¬Ù…ÙŠØ¹: ticket_updated
```

---

## ğŸ” Ø§Ù„Ø£Ù…Ø§Ù†

### Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
- âœ… CORS Ù…Ø­Ø¯ÙˆØ¯
- âœ… Validation Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

### Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
- âŒ Authentication ÙÙŠ Socket.IO
- âŒ Authorization checks
- âŒ Rate limiting
- âŒ Input sanitization Ù…Ø­Ø³Ù‘Ù†

---

## ğŸ“¦ Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª (Dependencies)

### Socket Server:
- `express` - HTTP server
- `socket.io` - WebSocket library
- `mongoose` - MongoDB ODM
- `cors` - CORS middleware
- `dotenv` - Environment variables

### Backend (Next.js):
- `mongoose` - MongoDB ODM
- `next` - React framework

---

## ğŸš€ Ø§Ù„ØªÙˆØ³Ø¹ (Scaling)

### Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
- Ø§Ø³ØªØ®Ø¯Ø§Ù… Rooms ÙÙŠ Socket.IO
- ÙÙ‡Ø±Ø³Ø© MongoDB

### Ø­Ù„ÙˆÙ„ Ù„Ù„ØªÙˆØ³Ø¹:
1. **Redis Adapter** - Ù„ØªÙˆØ²ÙŠØ¹ Socket.IO Ø¹Ø¨Ø± Ø¹Ø¯Ø© Ø®ÙˆØ§Ø¯Ù…
2. **Message Queue** - Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†
3. **CDN** - Ù„Ù„Ù…Ø±ÙÙ‚Ø§Øª ÙˆØ§Ù„ØµÙˆØ±
4. **Load Balancer** - Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø­Ù…Ø§Ù„

---

## ğŸ“ Ø§Ù„Ø®Ù„Ø§ØµØ©

### Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:
âœ… **Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„** Ù…Ø¹ Ù…ÙŠØ²Ø§Øª Ø¬ÙŠØ¯Ø© Ù„Ù„ØªÙˆØ§ØµÙ„ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ
âœ… **Ø¨Ù†ÙŠØ© Ù…Ø¹Ù…Ø§Ø±ÙŠØ© ÙˆØ§Ø¶Ø­Ø©** ÙˆØ³Ù‡Ù„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©
âœ… **ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù…ØªØ§Ø²Ø©** Ù…Ø¹ ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ©

### Ø§Ù„ØªÙˆØµÙŠØ§Øª:
1. Ø¥Ø¶Ø§ÙØ© Authentication Ùˆ Authorization
2. ØªØ­Ø³ÙŠÙ† Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
3. ØªÙˆØ­ÙŠØ¯ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
4. Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø¥Ø´Ø¹Ø§Ø±Ø§ØªØŒ Ø¨Ø­Ø«ØŒ ØªØµØ¯ÙŠØ±)
5. ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ù„Ù„ØªÙˆØ³Ø¹

---

## ğŸ“š Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©

- `socket-server/src/app.ts` - Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
- `socket-server/src/socket/index.ts` - Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Socket
- `models/Ticket.ts` - Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ°ÙƒØ±Ø©
- `hooks/use-ticket-socket.ts` - React Hook Ù„Ù„Ù€ Socket
- `app/api/tickets/route.ts` - API Routes

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ù„ÙŠÙ„**: 2024
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±**: 1.0

